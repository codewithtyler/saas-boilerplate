(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[437],{35706:function(e,t,r){Promise.resolve().then(r.bind(r,76258))},76258:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ProductsPage}});var n=r(57437),s=r(2265),a=r(24866),c=r(70388),o=r(11039),l=r(23611),i=r(66005),u=r(70708),d=r(57918);function ProductsPage(){let[e,t]=(0,s.useState)([]),[r,f]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let fetchProducts=async()=>{try{let e=await (0,o.Xp)();t(e)}catch(e){console.error("Error fetching products:",e)}finally{f(!1)}};fetchProducts()},[]),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)(a.x,{}),(0,n.jsx)(c.r,{children:(0,n.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("h2",{className:"text-2xl font-medium",children:"Products"}),(0,n.jsx)("p",{className:"text-[hsl(var(--md-secondary))]",children:"Manage your product catalog"})]}),(0,n.jsx)(l.z,{children:"Add Product"})]}),(0,n.jsx)("div",{className:"rounded-lg border",children:(0,n.jsxs)(i.iA,{children:[(0,n.jsx)(i.xD,{children:(0,n.jsxs)(i.SC,{children:[(0,n.jsx)(i.ss,{children:"Name"}),(0,n.jsx)(i.ss,{children:"Price"}),(0,n.jsx)(i.ss,{children:"Status"}),(0,n.jsx)(i.ss,{children:"Created"}),(0,n.jsx)(i.ss,{className:"text-right",children:"Action"})]})}),(0,n.jsx)(i.RM,{children:r?(0,n.jsx)(i.SC,{children:(0,n.jsx)(i.pj,{colSpan:5,className:"text-center",children:"Loading products..."})}):0===e.length?(0,n.jsx)(i.SC,{children:(0,n.jsx)(i.pj,{colSpan:5,className:"text-center",children:"No products found"})}):e.map(e=>(0,n.jsxs)(i.SC,{children:[(0,n.jsx)(i.pj,{className:"font-medium",children:e.name}),(0,n.jsxs)(i.pj,{children:["$",e.price.toFixed(2)]}),(0,n.jsx)(i.pj,{children:(0,n.jsx)(u.C,{variant:e.active?"default":"secondary",children:e.active?"Active":"Inactive"})}),(0,n.jsx)(i.pj,{children:(0,d.ZP)(new Date(e.created_at),"MMM d, yyyy")}),(0,n.jsx)(i.pj,{className:"text-right",children:(0,n.jsx)(l.z,{variant:"ghost",size:"sm",children:"Edit"})})]},e.id))})]})})]})})]})}},66005:function(e,t,r){"use strict";r.d(t,{RM:function(){return l},SC:function(){return u},iA:function(){return c},pj:function(){return f},ss:function(){return d},xD:function(){return o}});var n=r(57437),s=r(2265),a=r(81628);let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{className:"relative w-full overflow-auto",children:(0,n.jsx)("table",{ref:t,className:(0,a.cn)("w-full caption-bottom text-sm",r),...s})})});c.displayName="Table";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("thead",{ref:t,className:(0,a.cn)("[&_tr]:border-b",r),...s})});o.displayName="TableHeader";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("tbody",{ref:t,className:(0,a.cn)("[&_tr:last-child]:border-0",r),...s})});l.displayName="TableBody";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("tfoot",{ref:t,className:(0,a.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...s})});i.displayName="TableFooter";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("tr",{ref:t,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s})});u.displayName="TableRow";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("th",{ref:t,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...s})});d.displayName="TableHead";let f=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("td",{ref:t,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...s})});f.displayName="TableCell";let h=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("caption",{ref:t,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",r),...s})});h.displayName="TableCaption"},11039:function(e,t,r){"use strict";r.d(t,{HT:function(){return getRecentSales},IN:function(){return getActiveSubscriptions},OL:function(){return getCustomers},Xp:function(){return getProducts},cO:function(){return getActiveUsers},lp:function(){return getRevenue},og:function(){return getMonthlyRevenue},yp:function(){return getTotalSales}});var n=r(12899);let getCustomers=async()=>{try{let{data:e,error:t}=await n.O.from("customers").select("*, subscriptions(*)").order("created_at",{ascending:!1});if(t)throw t;return e}catch(e){return console.error("Error fetching customers:",e),[]}},getProducts=async()=>{try{let{data:e,error:t}=await n.O.from("products").select("*").order("created_at",{ascending:!1});if(t)throw t;return e}catch(e){return console.error("Error fetching products:",e),[]}},getRevenue=async()=>{try{let{data:e,error:t}=await n.O.from("payments").select("amount").gte("created_at",new Date(new Date().setMonth(new Date().getMonth()-1)).toISOString());if(t)throw t;return e.reduce((e,t)=>e+t.amount,0)}catch(e){return console.error("Error fetching revenue:",e),0}},getMonthlyRevenue=async()=>{try{let{data:e,error:t}=await n.O.from("payments").select("amount, created_at").gte("created_at",new Date(new Date().setFullYear(new Date().getFullYear()-1)).toISOString());if(t)throw t;let r=Array(12).fill(0);return e.forEach(e=>{let t=new Date(e.created_at);r[t.getMonth()]+=e.amount}),["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((e,t)=>({name:e,total:r[t]}))}catch(e){return console.error("Error fetching monthly revenue:",e),[]}},getActiveSubscriptions=async()=>{try{let{data:e,error:t}=await n.O.from("subscriptions").select("*").eq("status","active");if(t)throw t;return e.length}catch(e){return console.error("Error fetching active subscriptions:",e),0}},getTotalSales=async()=>{try{let{count:e,error:t}=await n.O.from("payments").select("*",{count:"exact"});if(t)throw t;return e||0}catch(e){return console.error("Error fetching total sales:",e),0}},getActiveUsers=async()=>{try{let{count:e,error:t}=await n.O.from("usage_logs").select("*",{count:"exact"}).gte("created_at",new Date(new Date().setHours(new Date().getHours()-1)).toISOString());if(t)throw t;return e||0}catch(e){return console.error("Error fetching active users:",e),0}},getRecentSales=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;try{let{data:t,error:r}=await n.O.from("payments").select("\n        *,\n        customers (\n          first_name,\n          last_name,\n          email\n        )\n      ").order("created_at",{ascending:!1}).limit(e);if(r)throw r;return t}catch(e){return console.error("Error fetching recent sales:",e),[]}}}},function(e){e.O(0,[579,700,390,600,918,315,971,472,744],function(){return e(e.s=35706)}),_N_E=e.O()}]);
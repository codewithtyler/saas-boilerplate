(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{71299:function(e,t,s){Promise.resolve().then(s.bind(s,7540))},7540:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return DashboardPage}});var r=s(57437),a=s(2265),n=s(24866),c=s(70388),l=s(11039),i=s(45253),o=s(87778),d=s(24235),u=s(50039),m=s(11399);function Overview(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let fetchData=async()=>{try{let e=await (0,l.og)();t(e)}catch(e){t(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(e=>({name:e,total:0})))}finally{n(!1)}};fetchData()},[]),s)?(0,r.jsx)("div",{className:"h-[350px] flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-full h-[200px] bg-muted animate-pulse rounded"})}):(0,r.jsx)(i.h,{width:"100%",height:350,children:(0,r.jsxs)(o.v,{data:e,children:[(0,r.jsx)(d.K,{dataKey:"name",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,r.jsx)(u.B,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>"$".concat(e)}),(0,r.jsx)(m.$,{dataKey:"total",fill:"currentColor",radius:[4,4,0,0],className:"fill-primary"})]})})}var f=s(67702);function RecentSales(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let fetchSales=async()=>{try{let e=await (0,l.HT)();t(e)}catch(e){t([])}finally{n(!1)}};fetchSales()},[]),s)?(0,r.jsx)("div",{className:"space-y-8",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-9 w-9 rounded-full bg-muted animate-pulse"}),(0,r.jsxs)("div",{className:"ml-4 space-y-1",children:[(0,r.jsx)("div",{className:"h-4 w-32 bg-muted animate-pulse rounded"}),(0,r.jsx)("div",{className:"h-3 w-24 bg-muted animate-pulse rounded"})]}),(0,r.jsx)("div",{className:"ml-auto h-4 w-16 bg-muted animate-pulse rounded"})]},t))}):0===e.length?(0,r.jsx)("div",{className:"flex h-[20vh] items-center justify-center text-muted-foreground",children:"No recent sales"}):(0,r.jsx)("div",{className:"space-y-8",children:e.map(e=>{var t,s,a,n,c,l,i,o,d;return(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)(f.qE,{className:"h-9 w-9",children:[(0,r.jsx)(f.F$,{src:"https://api.dicebear.com/7.x/initials/svg?seed=".concat(null===(t=e.customers)||void 0===t?void 0:t.first_name," ").concat(null===(s=e.customers)||void 0===s?void 0:s.last_name)}),(0,r.jsxs)(f.Q5,{children:[null===(n=e.customers)||void 0===n?void 0:null===(a=n.first_name)||void 0===a?void 0:a[0],null===(l=e.customers)||void 0===l?void 0:null===(c=l.last_name)||void 0===c?void 0:c[0]]})]}),(0,r.jsxs)("div",{className:"ml-4 space-y-1",children:[(0,r.jsxs)("p",{className:"text-sm font-medium leading-none",children:[null===(i=e.customers)||void 0===i?void 0:i.first_name," ",null===(o=e.customers)||void 0===o?void 0:o.last_name]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:null===(d=e.customers)||void 0===d?void 0:d.email})]}),(0,r.jsxs)("div",{className:"ml-auto font-medium",children:["+$",e.amount.toFixed(2)]})]},e.id)})})}var h=s(49598),x=s(41298),v=s(25750),g=s(4322),p=s(90998),j=s(98783);function DashboardPage(){let[e,t]=(0,a.useState)({revenue:0,subscriptions:0,sales:0,activeUsers:0,loading:!0});(0,a.useEffect)(()=>{let fetchStats=async()=>{try{let[e,s,r,a]=await Promise.all([(0,l.lp)(),(0,l.IN)(),(0,l.yp)(),(0,l.cO)()]);t({revenue:e,subscriptions:s,sales:r,activeUsers:a,loading:!1})}catch(e){t(e=>({revenue:0,subscriptions:0,sales:0,activeUsers:0,loading:!1}))}};fetchStats()},[]);let s=[{title:"Revenue",value:"$".concat(e.revenue.toFixed(2)),change:"+0%",icon:x.Z},{title:"Subscriptions",value:e.subscriptions.toString(),change:"+0%",icon:v.Z},{title:"Sales",value:e.sales.toString(),change:"+0%",icon:g.Z},{title:"Active Now",value:e.activeUsers.toString(),change:"+0",icon:p.Z}];return(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(n.x,{}),(0,r.jsx)(c.r,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("h2",{className:"text-2xl font-medium",children:"Welcome back"}),(0,r.jsx)("p",{className:"text-[hsl(var(--md-secondary))]",children:"Here's what's happening with your business today."})]}),(0,r.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:s.map((t,s)=>(0,r.jsxs)(h.Zb,{className:"material-card",children:[(0,r.jsxs)(h.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,r.jsx)(h.ll,{className:"text-sm font-medium text-[hsl(var(--md-secondary))]",children:t.title}),(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-md bg-[hsl(var(--md-primary-container))]",children:(0,r.jsx)(t.icon,{className:"h-5 w-5 text-[hsl(var(--md-on-primary-container))]"})})]}),(0,r.jsx)(h.aY,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[e.loading?(0,r.jsx)("div",{className:"h-8 w-24 bg-muted animate-pulse rounded"}):(0,r.jsx)("div",{className:"text-2xl font-medium",children:t.value}),(0,r.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,r.jsx)(j.Z,{className:"h-4 w-4 text-[hsl(var(--md-primary))]"}),(0,r.jsx)("span",{className:"text-[hsl(var(--md-primary))] font-medium",children:t.change}),(0,r.jsx)("span",{className:"text-[hsl(var(--md-secondary))]",children:"vs last month"})]})]})})]},s))}),(0,r.jsxs)("div",{className:"grid gap-6 md:grid-cols-7",children:[(0,r.jsxs)(h.Zb,{className:"material-card md:col-span-4",children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{className:"font-medium",children:"Overview"})}),(0,r.jsx)(h.aY,{children:(0,r.jsx)(Overview,{})})]}),(0,r.jsxs)(h.Zb,{className:"material-card md:col-span-3",children:[(0,r.jsx)(h.Ol,{children:(0,r.jsx)(h.ll,{className:"font-medium",children:"Recent Sales"})}),(0,r.jsx)(h.aY,{children:(0,r.jsx)(RecentSales,{})})]})]})]})})]})}},49598:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return c},aY:function(){return d},eW:function(){return u},ll:function(){return i}});var r=s(57437),a=s(2265),n=s(81628);let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});c.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});i.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})});o.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"},11039:function(e,t,s){"use strict";s.d(t,{HT:function(){return getRecentSales},IN:function(){return getActiveSubscriptions},OL:function(){return getCustomers},Xp:function(){return getProducts},cO:function(){return getActiveUsers},lp:function(){return getRevenue},og:function(){return getMonthlyRevenue},yp:function(){return getTotalSales}});var r=s(12899);let getCustomers=async()=>{try{let{data:e,error:t}=await r.O.from("customers").select("*, subscriptions(*)").order("created_at",{ascending:!1});if(t)throw t;return e}catch(e){return console.error("Error fetching customers:",e),[]}},getProducts=async()=>{try{let{data:e,error:t}=await r.O.from("products").select("*").order("created_at",{ascending:!1});if(t)throw t;return e}catch(e){return console.error("Error fetching products:",e),[]}},getRevenue=async()=>{try{let{data:e,error:t}=await r.O.from("payments").select("amount").gte("created_at",new Date(new Date().setMonth(new Date().getMonth()-1)).toISOString());if(t)throw t;return e.reduce((e,t)=>e+t.amount,0)}catch(e){return console.error("Error fetching revenue:",e),0}},getMonthlyRevenue=async()=>{try{let{data:e,error:t}=await r.O.from("payments").select("amount, created_at").gte("created_at",new Date(new Date().setFullYear(new Date().getFullYear()-1)).toISOString());if(t)throw t;let s=Array(12).fill(0);return e.forEach(e=>{let t=new Date(e.created_at);s[t.getMonth()]+=e.amount}),["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((e,t)=>({name:e,total:s[t]}))}catch(e){return console.error("Error fetching monthly revenue:",e),[]}},getActiveSubscriptions=async()=>{try{let{data:e,error:t}=await r.O.from("subscriptions").select("*").eq("status","active");if(t)throw t;return e.length}catch(e){return console.error("Error fetching active subscriptions:",e),0}},getTotalSales=async()=>{try{let{count:e,error:t}=await r.O.from("payments").select("*",{count:"exact"});if(t)throw t;return e||0}catch(e){return console.error("Error fetching total sales:",e),0}},getActiveUsers=async()=>{try{let{count:e,error:t}=await r.O.from("usage_logs").select("*",{count:"exact"}).gte("created_at",new Date(new Date().setHours(new Date().getHours()-1)).toISOString());if(t)throw t;return e||0}catch(e){return console.error("Error fetching active users:",e),0}},getRecentSales=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;try{let{data:t,error:s}=await r.O.from("payments").select("\n        *,\n        customers (\n          first_name,\n          last_name,\n          email\n        )\n      ").order("created_at",{ascending:!1}).limit(e);if(s)throw s;return t}catch(e){return console.error("Error fetching recent sales:",e),[]}}}},function(e){e.O(0,[579,700,390,600,852,315,971,472,744],function(){return e(e.s=71299)}),_N_E=e.O()}]);